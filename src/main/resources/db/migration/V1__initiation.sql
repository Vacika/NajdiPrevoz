CREATE TABLE public.authorities
(
    id        bigint             NOT NULL,
    authority varchar(30) UNIQUE NOT NULL
);

alter table public.authorities
    owner to najdiprevoz;

ALTER TABLE public.authorities
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .authorities_id_seq
            START WITH 3
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );

CREATE TABLE public.cars
(
    id               bigint NOT NULL,
    brand            character varying(255),
    model            character varying(255),
    total_seats      integer,
    year_manufacture integer,
    owner_id         bigint
);


ALTER TABLE public.cars
    OWNER TO najdiprevoz;



ALTER TABLE public.cars
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .cars_id_seq
            START WITH 11
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



CREATE TABLE public.cities
(
    id   bigint NOT NULL,
    name character varying(255)
);


ALTER TABLE public.cities
    OWNER TO najdiprevoz;



ALTER TABLE public.cities
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .cities_id_seq
            START WITH 36
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



CREATE TABLE public.member_preferences
(
    id                 bigint NOT NULL,
    is_pet_allowed     boolean,
    is_smoking_allowed boolean,
    member_id          bigint
);


ALTER TABLE public.member_preferences
    OWNER TO najdiprevoz;



ALTER TABLE public.member_preferences
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .member_preferences_id_seq
            START WITH 11
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



CREATE TABLE public.users
(
    id            bigint                      NOT NULL,
    birth_date    timestamp without time zone NOT NULL,
    username      character varying(255)      NOT NULL UNIQUE,
    first_name    character varying(255)      NOT NULL,
    gender        character varying(255)      NOT NULL,
    last_name     character varying(255)      NOT NULL,
    password      character varying(255)      NOT NULL,
    phone_number  character varying(255)      NOT NULL,
    authority_id  bigint                      NOT NULL,
    profile_photo character varying(255)
);


ALTER TABLE public.users
    OWNER TO najdiprevoz;



ALTER TABLE public.users
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .users_id_seq
            START WITH 11
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



CREATE TABLE public.ratings
(
    id              bigint  NOT NULL,
    date_submitted  timestamp without time zone,
    note            character varying(255),
    rating          integer NOT NULL,
    ride_request_id bigint  NOT NULL
);


ALTER TABLE public.ratings
    OWNER TO najdiprevoz;



ALTER TABLE public.ratings
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .ratings_id_seq
            START WITH 4
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



CREATE TABLE public.ride_requests
(
    id           bigint NOT NULL,
    created_on   timestamp without time zone,
    status       character varying(255),
    requester_id bigint,
    ride_id      bigint NOT NULL
);


ALTER TABLE public.ride_requests
    OWNER TO najdiprevoz;



ALTER TABLE public.ride_requests
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .ride_requests_id_seq
            START WITH 4
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



CREATE TABLE public.rides
(
    id                  bigint NOT NULL,
    description         character varying(255),
    created_on          timestamp without time zone,
    departure_time      timestamp without time zone,
    price_per_head      integer,
    total_seats_offered integer,
    to_location         bigint,
    driver_id           bigint NOT NULL,
    from_location       bigint,
    status              varchar(255)
);


ALTER TABLE public.rides
    OWNER TO najdiprevoz;



ALTER TABLE public.rides
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .rides_id_seq
            START WITH 3
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



create table notifications
(
    id                bigint  NOT NULL,
    actions_available varchar(255),
    created_on        timestamp,
    from_id           bigint  not null,
    to_id             bigint  not null,
    seen              boolean not null,
    type              varchar(255),
    ride_request_id   bigint  not null
);

alter table notifications
    owner to najdiprevoz;

ALTER TABLE public.notifications
    ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
        SEQUENCE NAME public .notifications_id_seq
            START WITH 1
            INCREMENT BY 1
            NO MINVALUE
            NO MAXVALUE
            CACHE 1
        );



INSERT INTO public.cars
VALUES (1, 'Toyota', 'RAV4', 5, 2017, 1);
INSERT INTO public.cars
VALUES (2, 'BMW', 'X6', 5, 2009, 2);
INSERT INTO public.cars
VALUES (3, 'Volvo', 'xc90', 5, 2015, 3);
INSERT INTO public.cars
VALUES (4, 'Ford', 'Fiesta', 4, 2017, 4);
INSERT INTO public.cars
VALUES (5, 'Ford', 'Mondeo', 5, 2004, 5);
INSERT INTO public.cars
VALUES (6, 'Volkswagen', 'Golf 4', 5, 2001, 6);
INSERT INTO public.cars
VALUES (7, 'Volkswagen', 'UP', 4, 2018, 7);
INSERT INTO public.cars
VALUES (8, 'Audi', 'Q7', 5, 2017, 8);
INSERT INTO public.cars
VALUES (9, 'Mercedes', 'C350', 5, 2013, 9);
INSERT INTO public.cars
VALUES (10, 'Honda', 'Civic', 5, 2006, 10);



INSERT INTO public.cities(id, name)
VALUES (1, 'Skopje'),
       (2, 'Struga'),
       (3, 'Strumica'),
       (4, 'Ohrid'),
       (5, 'Debar'),
       (6, 'Gostivar'),
       (7, 'Resen'),
       (8, 'Prilep'),
       (9, 'Bitola'),
       (10, 'Tetovo'),
       (11, 'Pehcevo'),
       (12, 'Kicevo'),
       (13, 'Mavrovo'),
       (14, 'Kumanovo'),
       (15, 'Veles'),
       (16, 'Gevgelija'),
       (17, 'Negotino'),
       (18, 'Kavadarci'),
       (19, 'Stip'),
       (20, 'Probistip'),
       (21, 'Kocani'),
       (22, 'Sveti Nikole'),
       (23, 'Delcevo'),
       (24, 'Makedonski brod'),
       (25, 'Makedonska Kamenica'),
       (26, 'Vinica'),
       (27, 'Valandovo'),
       (28, 'Krusevo'),
       (29, 'Radovish'),
       (30, 'Kriva Palanka'),
       (31, 'Berovo'),
       (32, 'Demir kapija'),
       (33, 'Kratovo'),
       (34, 'Demir hisar'),
       (35, 'Dojran');



INSERT INTO public.member_preferences
VALUES (1, false, false, 1),
       (2, false, true, 2),
       (3, true, false, 3),
       (4, true, true, 4),
       (5, false, true, 5),
       (6, true, true, 6),
       (7, false, false, 7),
       (8, true, false, 8),
       (9, false, true, 9),
       (10, true, true, 10);

insert into public.authorities(id, authority)
VALUES (1, 'ROLE_USER'),
       (2, 'ROLE_ADMIN');


INSERT INTO public.ratings(id, date_submitted, note, rating, ride_request_id)
VALUES (1, '2020-02-12 21:01:04', 'dobra voznja', 5, 1),
       (2, '2020-02-12 21:01:15', 'mnogu loso', 1, 3),
       (3, '2020-02-12 21:04:36', 'Meh,sredno', 3, 2);



insert into public.users(id, birth_date, username, first_name, gender, last_name, password, phone_number, authority_id,
                         profile_photo)
VALUES (1, '2020-02-11 22:00:06', 'email@email.com', 'John', 'M', 'Smith', 'password', '071711033', 1, NULL),
       (2, '2020-02-11 22:00:06', 'email2@email.com', 'Jane', 'F', 'Doe', 'password', '45282138', 1, NULL),
       (3, '2020-02-11 22:00:06', 'email3@email.com', 'Thierry', 'M', 'Henry', 'password', '357429566', 1, NULL),
       (4, '2020-02-11 22:00:06', 'email4@email.com', 'Renath', 'M', 'Minerou', 'password', '071711033', 1, NULL),
       (5, '2020-02-11 22:00:06', 'email5@email.com', 'Millow', 'M', 'Hobs', 'password', '071711033', 1, NULL),
       (6, '2020-02-11 22:00:06', 'email6@email.com', 'Nathan', 'M', 'Bowie', 'password', '071711033', 1, NULL),
       (7, '2020-02-11 22:00:06', 'email7@email.com', 'John', 'M', 'Lennon', 'password', '071711033', 1, NULL),
       (8, '2020-02-11 22:00:06', 'email8@email.com', 'Jennifer', 'F', 'Lopez', 'password', '071711033', 1, NULL),
       (9, '2020-02-11 22:00:06', 'email9@email.com', 'Danielle', 'F', 'Rossi', 'password', '071711033', 1, NULL),
       (10, '2020-02-11 22:00:06', 'email10@email.com', 'Adrianna', 'F', 'Lima', 'password', '071711033', 1, NULL);


INSERT INTO public.ride_requests(id, created_on, status, requester_id, ride_id)
VALUES (1, '2020-02-12 19:50:27', 'APPROVED', 1, 1),
       (2, '2020-02-12 19:50:27', 'PENDING', 1, 2),
       (3, '2020-02-12 19:50:27', 'PENDING', 1, 2);

INSERT INTO public.rides(id, description, created_on, departure_time, price_per_head, total_seats_offered, to_location,
                         driver_id, from_location, status)
VALUES (1, 'test-description', '2020-02-12 19:50:55', '2020-02-12 19:50:57', 100, 5, 1, 1, 2, 'ACTIVE'),
       (2, 'test-ride-2', '2020-02-12 21:04:51', '2020-02-12 21:04:55', 150, 3, 1, 2, 1, 'ACTIVE');



ALTER TABLE ONLY public.authorities
    ADD CONSTRAINT authorities_pkey PRIMARY KEY (id);

ALTER TABLE ONLY public.cars
    ADD CONSTRAINT cars_pkey PRIMARY KEY (id);



ALTER TABLE ONLY public.cities
    ADD CONSTRAINT cities_pkey PRIMARY KEY (id);



ALTER TABLE ONLY public.member_preferences
    ADD CONSTRAINT member_preferences_pkey PRIMARY KEY (id);



ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);



ALTER TABLE ONLY public.ratings
    ADD CONSTRAINT ratings_pkey PRIMARY KEY (id);



ALTER TABLE ONLY public.ride_requests
    ADD CONSTRAINT ride_requests_pkey PRIMARY KEY (id);



ALTER TABLE ONLY public.rides
    ADD CONSTRAINT rides_pkey PRIMARY KEY (id);


ALTER TABLE ONLY public.notifications
    ADD CONSTRAINT notifications_pkey PRIMARY KEY (id);



ALTER TABLE ONLY public.users
    ADD CONSTRAINT uk_q0u5f2cdlshec8tlh6818bhbk FOREIGN KEY (authority_id) REFERENCES public.users (id);
ALTER TABLE ONLY public.ride_requests
    ADD CONSTRAINT fk4mlf748wvd1c16p2at7mkux39 FOREIGN KEY (ride_id) REFERENCES public.rides (id);

ALTER TABLE ONLY public.rides
    ADD CONSTRAINT fkgco6pwrgn8co7gwyludy1nnc1 FOREIGN KEY (from_location) REFERENCES public.cities (id);

ALTER TABLE ONLY public.cars
    ADD CONSTRAINT fkm9dna12woo9bxuhtbdlhek4al FOREIGN KEY (owner_id) REFERENCES public.users (id);

ALTER TABLE ONLY public.rides
    ADD CONSTRAINT fko62n3qexfjtslknusqfjfcs2p FOREIGN KEY (to_location) REFERENCES public.cities (id);

ALTER TABLE ONLY public.ride_requests
    ADD CONSTRAINT fkoc5uj7y01drryd0itrmnkk1kf FOREIGN KEY (requester_id) REFERENCES public.users (id);

ALTER TABLE ONLY public.ratings
    ADD CONSTRAINT fkndfvgd6891sq1h8sipcw0ddu7 FOREIGN KEY (ride_request_id) REFERENCES public.ride_requests (id);

ALTER TABLE ONLY public.rides
    ADD CONSTRAINT fkq0n68ras6f40ck5lqccd3v75n FOREIGN KEY (driver_id) REFERENCES public.users (id);

ALTER TABLE ONLY public.member_preferences
    ADD CONSTRAINT fkr36s4dryxkuqc91v9bfl7nxc7 FOREIGN KEY (member_id) REFERENCES public.users (id);

ALTER TABLE ONLY public.notifications
    ADD CONSTRAINT fklij3ynti4lrb8otc71ofaf0gd FOREIGN KEY (ride_request_id) REFERENCES public.ride_requests (id);

ALTER TABLE ONLY public.notifications
    ADD CONSTRAINT fkd25nxsqv33bpyn7k4ilpnag9k FOREIGN KEY (from_id) REFERENCES public.users (id);

ALTER TABLE ONLY public.notifications
    ADD CONSTRAINT fkkytmopvxrwrgrkyqiu4lr0624 FOREIGN KEY (from_id) REFERENCES public.users (id);




